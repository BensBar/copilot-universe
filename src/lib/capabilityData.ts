// Code reverted to commit 646aaa9f9c9639edf5527e649fca6d452da6d613
// ... (original file content) ...